!function(e){function t(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,t),r.l=!0,r.exports}var i={};t.m=e,t.c=i,t.i=function(e){return e},t.d=function(e,i,n){t.o(e,i)||Object.defineProperty(e,i,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var i=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(i,"a",i),i},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=0)}([function(e,t,i){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o={debounce:function(e,t){var i=this,n=arguments,r=void 0;return function(){clearTimeout(r),r=setTimeout(function(){e.apply(i,n)},t)}},getPicInfo:function(e){var t=e.src||"",i=e.fastCallback,n=e.loadedCallback,r=e.errorCallback,o=new Image,c={isError:!1,width:0,height:0},s=function(){(c.isError||o.width>0||o.height>0)&&(clearInterval(a),c.width=o.width,c.height=o.height,i&&i(c))},a=void 0;o.src=t,o.addEventListener("error",function(e){c.isError=!0,r&&r(c)},!1),o.complete?(c.width=o.width,c.height=o.height,i&&i(c),n&&n(c)):(o.addEventListener("load",function(){c.width=o.width,c.height=o.height,n&&n(c)},!1),a=setInterval(s,50))}},c=function(){function e(t){n(this,e),this.emptyPic="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",this.defaultPic=t&&t.defaultPic||this.emptyPic,this.errorPic=t&&t.errorPic||this.emptyPic,this.container=t&&t.container||window,this.threshold=t&&t.threshold||0,this.effectFadeIn=t&&t.effectFadeIn||!1,this.callback=t&&t.callback||new Function,this.selector=t&&t.selector||[],this.event=["scroll","resize"],this.delayRender=o.debounce(this.render.bind(this),200)}return r(e,[{key:"inView",value:function(e){var t=!1,i=e.getBoundingClientRect(),n=this.container==window?window.innerWidth:this.container.clientWidth,r=this.container==window?window.innerHeight:this.container.clientHeight;return i.bottom>this.threshold&&i.top+this.threshold<r&&i.right>this.threshold&&i.left+this.threshold<n&&(t=!0),t}},{key:"bindUI",value:function(e){var t=this;this.event.forEach(function(i,n){t.container.addEventListener(i,e,!1)})}},{key:"unbindUI",value:function(e){var t=this;this.event.forEach(function(i,n){t.container.removeEventListener(i,e,!1)})}},{key:"render",value:function(){var e=this;this.isLoadEvent||(this.isLoadEvent=!0,this.bindUI(this.delayRender)),this.selector.length||this.unbindUI(this.delayRender);for(var t=0;t<this.selector.length;t++){(function(i){var n=e.selector[i];if(n.ele.getAttribute("data-src")||(n.ele.setAttribute("data-src",n.src),n.ele.setAttribute("status","loading")),n.ele.getAttribute("src")||n.ele.setAttribute("src",e.defaultPic),"none"==getComputedStyle(n.ele,null).display)return e.selector.splice(i--,1),"continue";e.inView(n.ele)&&("img"==n.ele.nodeName.toLowerCase()&&o.getPicInfo({src:n.src,errorCallback:function(t){n.ele.src=e.errorPic,n.ele.setAttribute("status","error")},loadedCallback:function(t){e.effectFadeIn&&(n.ele.style.opacity=0),n.ele.src=t.isError?e.errorPic:n.src,n.ele.removeAttribute("data-src"),n.ele.setAttribute("status","loaded"),setTimeout(function(){n.ele.style.opacity=1,n.ele.style.transition="all 1s"},50)}}),e.callback(n.ele,n.src),e.selector.splice(i--,1)),t=i})(t)}}}]),e}();t.default={install:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=new RegExp("((\\..{1,4})|(/))$"),n={},r=void 0;e.directive("view",{bind:function(s,a){var l=void 0==a.arg?"window":a.arg;void 0==n[l]&&(n[l]=[]),n[l].push({ele:s,src:i.test(a.value)?a.value:i.test(a.expression)?a.expression:""}),e.nextTick(function(){void 0===r&&(r=o.debounce(function(){for(var e in n)t.container="window"==e?window:document.getElementById(e),t.selector=n[e],new c(t).delayRender()},200)),r()})}})}}}]);